  <!-- Sticky Topbar -->
  <div class="position-sticky top-0 bg-danger text-light d-flex justify-content-between align-items-center px-3 py-2 shadow-sm" style="z-index: 1030;">
    <%= link_to lists_path, class: "btn btn-outline-light btn-sm d-flex align-items-center" do %>
      <i class="bi bi-arrow-left me-2"></i> Back
    <% end %>

    <h1 class="h4 fw-bold m-0 text-center flex-grow-1"><%= @selected_list.name %></h1>

    <button type="button"
            class="btn btn-dark fw-bold shadow-sm"
            data-bs-toggle="modal"
            data-bs-target="#addMovieModal">
      Add Movie to List
    </button>
  </div>


  <!-- Add Movie Modal -->
  <div class="modal fade mb-4" id="addMovieModal" tabindex="-1" aria-labelledby="addMovieModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark text-light border-secondary shadow-lg p-3">

        <div class="modal-header border-secondary">
          <h5 class="modal-title fw-bold" id="addMovieModalLabel">
            Add a Movie to <%= @selected_list.name %>
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body">
          <%= simple_form_for([@selected_list, @bookmark]) do |f| %>
            <div class="mb-3">
              <%= f.association :movie,
                    collection: Movie.all.order(:title),
                    prompt: "Select a movie",
                    label: false,
                    input_html: { class: "form-select bg-secondary text-light border-0 shadow-none" } %>
            </div>

            <div class="mb-3">
              <%= f.input :comment,
                    label: false,
                    placeholder: "Add your thoughts about this movie...",
                    input_html: { class: "form-control bg-secondary text-light border-0 shadow-none" } %>
            </div>

            <div class="d-grid">
              <%= f.submit "Add Movie", class: "btn btn-primary fw-bold shadow-sm" %>
            </div>
          <% end %>
        </div>

      </div>
    </div>
  </div>


  <!-- Movie Sections -->
  <% if @selected_list.bookmarks.any? %>
    <% featured = @selected_list.bookmarks.first.movie %>
    <% others = @selected_list.bookmarks.drop(1).map(&:movie) %>

    <!-- Featured Hero Movie -->
    <div class="container">
      <div class="row align-items-center g-4 p-4 rounded bg-dark  text-light shadow-lg">

        <!-- Cover -->
        <div class="col-12 col-md-5">
          <% if featured.poster_url.present? %>
            <img src="<%= featured.poster_url %>"
                alt="<%= featured.title %>"
                class="img-fluid rounded shadow-lg object-fit-cover"
                style="width: 100%; max-height: 600px; object-fit: cover;">
          <% else %>
            <div class="bg-secondary text-center d-flex align-items-center justify-content-center rounded" style="height: 400px;">
              <span class="text-muted">No image</span>
            </div>
          <% end %>
        </div>

        <!-- üìù Content -->
        <div class="col-12 col-md-7">
          <h2 class="fw-bold mb-3 display-5"><%= featured.title %></h2>
          <p class="lead mb-4"><%= truncate(featured.overview, length: 250) %></p>

          <% if featured.rating.present? %>
            <span class="badge bg-danger fs-6 mb-3">‚≠ê <%= featured.rating.round(1) %></span>
          <% end %>



      </div>
    </div>

    <!-- Movie Grid -->
    <div class="row row-cols-2 row-cols-sm-3 row-cols-md-4 row-cols-lg-5 g-4 mt-2">
      <%= render partial: "movies/movie", collection: others, as: :movie %>
    </div>

  <% else %>
    <p class="text-secondary mt-5">No movies in this list yet.</p>
  <% end %>
